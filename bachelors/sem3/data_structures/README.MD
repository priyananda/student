This is terrible terrible code written before I knew how to write code. It also didn't help that we used TurboC.

None of this compiles in any modern compiler. I have not wasted time porting it.